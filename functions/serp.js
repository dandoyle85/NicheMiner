export const onRequest = async ({ request, env }) => {const key=env.SERP_API_KEY||'';if(!key)return new Response(JSON.stringify([]),{headers:{'content-type':'application/json'}});const url=new URL(request.url);const q=url.searchParams.get('q')||'profitable niches';const u='https://serpapi.com/search.json?'+new URLSearchParams({engine:'google',q,api_key:key,hl:'en',gl:'us'}).toString();const r=await fetch(u);if(!r.ok)return new Response(JSON.stringify([]),{headers:{'content-type':'application/json'}});const j=await r.json();const items=(j.organic_results||[]).slice(0,25).map(x=>({topic:x.title,volume:1,engagement:(x.position?60-x.position:5),trend:'up',compIndex:.6,intent:'Mixed',source:'SERP'}));return new Response(JSON.stringify(items),{headers:{'content-type':'application/json'}});};