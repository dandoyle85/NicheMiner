
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Auto Niche Miner Pro â€” Phase 7 (Niches)</title>
<style>
  body{margin:0;background:#0e1117;color:#e8eef7;font-family:system-ui,-apple-system,Segoe UI,Roboto}
  header{background:#0b1018;padding:12px;border-bottom:1px solid #22344d}
  h1{margin:0;font-size:18px}
  nav{display:flex;gap:16px;margin-top:8px}
  nav a{color:#9bb0c5;text-decoration:none;padding:6px 10px;border-radius:8px}
  nav a.active{color:#cfe1ff;background:#0f1623;border:1px solid #2c3f5c}
  .wrap{max-width:1200px;margin:0 auto;padding:14px}
  .card{background:#131a24;border:1px solid #22344d;border-radius:12px;padding:14px;margin-top:14px}
  .btn{padding:6px 10px;border:none;border-radius:8px;cursor:pointer}
  .btn-primary{background:#1d3a6a;color:#cfe1ff}
  .btn-apply{background:#2e7d32;color:#fff}
  table{width:100%;border-collapse:collapse;font-size:13px;margin-top:10px}
  th,td{padding:8px;border-bottom:1px solid #1c2535;text-align:left}
  th{background:#0e1420;color:#a7b4c7;font-size:11px;text-transform:uppercase}
  .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:16px;background:#22344d;color:#cfe1ff;border:1px solid #2f4c70;border-radius:8px;padding:8px 12px;opacity:0;transition:opacity .25s ease;z-index:50}
  .toast.show{opacity:1}
</style>
</head>
<body>
<header>
  <h1>ðŸ§­ Auto Niche Miner Pro â€” Phase 7</h1>
  <nav>
    <a href="#" id="navEmpire">Empire</a>
    <a href="#" id="navHub">Affiliate Hub</a>
    <a href="#" id="navNiches" class="active">Niches</a>
  </nav>
</header>

<main class="wrap">
  <!-- Niches Page -->
  <section class="card" id="niches">
    <h3>ðŸ”¥ Trending Niches (Mock Data)</h3>
    <table id="nicheTable">
      <thead><tr><th>Niche</th><th>Actions</th></tr></thead>
      <tbody></tbody>
    </table>
  </section>

  <!-- Keyword Drilldown -->
  <section class="card" id="keywords" style="display:none">
    <h3 id="kwTitle">Keywords</h3>
    <table id="keywordTable">
      <thead><tr><th>Select</th><th>Keyword</th><th>Volume</th><th>Competition</th></tr></thead>
      <tbody></tbody>
    </table>
    <button class="btn btn-apply" id="saveKeywordsBtn">Save Selection</button>
  </section>
</main>

<div class="toast" id="toast"></div>

<script type="module">
  import { saveKeywords } from './supabase-client.js';

  const MOCK_NICHES = ["Drones","Solar Panels","Home Fitness","Smart Home","Outdoor Gear"];
  const MOCK_KEYWORDS = {
    "Drones":[
      {keyword:"best drones under 500",volume:12000,competition:"Low"},
      {keyword:"drone mapping software",volume:8000,competition:"Medium"},
      {keyword:"fpv drones racing",volume:5000,competition:"High"}
    ],
    "Solar Panels":[
      {keyword:"solar panel installation cost",volume:15000,competition:"Medium"},
      {keyword:"best home solar kits",volume:9000,competition:"Low"}
    ],
    "Home Fitness":[
      {keyword:"resistance band workout",volume:10000,competition:"Low"},
      {keyword:"best home treadmill",volume:7000,competition:"Medium"}
    ]
  };

  const nicheTableBody=document.querySelector("#nicheTable tbody");
  const kwTableBody=document.querySelector("#keywordTable tbody");
  const kwSection=document.getElementById("keywords");
  let currentNiche=null;

  function renderNiches(){
    nicheTableBody.innerHTML="";
    MOCK_NICHES.forEach(n=>{
      const tr=document.createElement("tr");
      tr.innerHTML=\`<td>\${n}</td><td><button class="btn btn-primary">Drill Keywords</button></td>\`;
      tr.querySelector("button").onclick=()=> showKeywords(n);
      nicheTableBody.appendChild(tr);
    });
  }

  function showKeywords(niche){
    currentNiche=niche;
    document.getElementById("kwTitle").textContent=\`Keywords for \${niche}\`;
    kwSection.style.display="block";
    kwTableBody.innerHTML="";
    const kws=MOCK_KEYWORDS[niche]||[{keyword:"generic keyword",volume:1000,competition:"Low"}];
    kws.forEach(k=>{
      const tr=document.createElement("tr");
      tr.innerHTML=\`<td><input type="checkbox"/></td><td>\${k.keyword}</td><td>\${k.volume}</td><td>\${k.competition}</td>\`;
      tr.dataset.keyword=JSON.stringify(k);
      kwTableBody.appendChild(tr);
    });
  }

  document.getElementById("saveKeywordsBtn").onclick=async()=>{
    const selected=[];
    kwTableBody.querySelectorAll("tr").forEach(tr=>{
      if(tr.querySelector("input").checked){
        selected.push(JSON.parse(tr.dataset.keyword));
      }
    });
    if(selected.length===0){toast("No keywords selected");return;}
    const saved=await saveKeywords(currentNiche,selected);
    if(saved){toast("âœ… "+selected.length+" keywords saved for "+currentNiche);}
  };

  function toast(msg){
    const t=document.getElementById("toast");
    t.textContent=msg; t.classList.add("show");
    setTimeout(()=> t.classList.remove("show"),1600);
  }

  renderNiches();
</script>
</body>
</html>
